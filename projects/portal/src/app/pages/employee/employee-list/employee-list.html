<!-- customer-list.component.html -->
<div class="w-full">
    <!-- Header: Search + Add -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6">
        <div
            class="flex flex-col sm:flex-row items-center justify-between gap-4 w-full bg-white p-4 rounded-xl shadow-sm border border-slate-200">
            <!-- Search Bar -->
            <div class="relative w-full sm:w-80 md:w-96">
                <input type="text" placeholder="Search customers by name, email, username or contact..."
                    class="w-full pl-10 pr-4 py-2 rounded-lg border border-slate-300 bg-gray-50 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" />
                <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400">
                    <!-- Search Icon -->
                    <svg class="w-5 h-5" f  ill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M21 21l-4.35-4.35M11 19a8 8 0 100-16 8 8 0 000 16z" />
                    </svg>
                </span>
            </div>

            <!-- Add Button -->
            <div>
                <button type="button" (click)="addEmployee()"
                    class="inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white font-medium rounded-lg shadow-sm hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-400 focus:outline-none transition cursor-pointer">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                    </svg>
                    Add Employee
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Table -->
<div class="rounded-lg border border-slate-200 shadow-sm overflow-x-auto">
    <table class="min-w-full divide-y divide-slate-200">
        <thead class="bg-slate-50">
            <tr>
                <th class="px-4 py-3 text-left text-sm font-medium text-slate-700">#</th>
                <th class="px-4 py-3 text-left text-sm font-medium text-slate-700 cursor-pointer select-none">
                    Name
                    <svg class="inline w-3 h-3 ml-1 text-slate-400" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M5 8l5-5 5 5H5z" />
                    </svg>
                </th>
                <th class="px-4 py-3 text-left text-sm font-medium text-slate-700">Email</th>
                <th class="px-4 py-3 text-left text-sm font-medium text-slate-700">Contact</th>
                <th class="px-4 py-3 text-left text-sm font-medium text-slate-700">Username</th>
                <th class="px-4 py-3 text-left text-sm font-medium text-slate-700">Actions</th>
            </tr>
        </thead>

        <tbody class="bg-white divide-y divide-slate-100">
          @for (employee of employees; track $index) {
              <tr class="hover:bg-slate-50" >
                <td class="px-4 py-3 text-sm text-slate-600">{{$index+1}}</td>
                <td class="px-4 py-3 text-sm">
                    <div class="flex items-center gap-3">
                        <div
                            class="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-700 font-medium">
                            JD
                        </div>
                        <div>
                            <div class="text-slate-900 font-medium">{{employee.firstName + employee.lastName}}</div>
                            <div class="text-xs text-slate-500">jane.doe@example.com</div>
                        </div>
                    </div>
                </td>
                <td class="px-4 py-3 text-sm text-slate-700">{{employee.email}}</td>
                <td class="px-4 py-3 text-sm text-slate-700"> {{employee.contact}}</td>
                <td class="px-4 py-3 text-sm text-slate-700">{{employee.userTypeId}}</td>
                <td class="px-4 py-3 text-sm">
                    <div class="flex items-center gap-2">
                        <button class="px-2 py-1 rounded-md bg-blue-50 text-blue-600 hover:bg-blue-100" (click)="fetchEmployee(employee.id)">
                            Edit
                        </button>
                        <button class="px-2 py-1 rounded-md bg-red-50 text-red-600 hover:bg-red-100" (click)="deleteEmployee(employee.id)"> 
                            Delete
                        </button>
                    </div>
                </td>
            </tr>
          }

          
        </tbody>
    </table>
</div>
<app-pagination-controller [paginationControlMetaData]="paginationMetadata"></app-pagination-controller>

@if(employeeForm){
<div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
    <!-- Popup Container -->
    <div class="bg-white w-full max-w-5xl rounded-2xl shadow-lg p-8 relative">
        <!-- Close Button -->
        <button class="absolute top-3 right-3 text-gray-500 hover:text-gray-800 text-2xl font-bold cursor-pointer"
            (click)="employeeForm = false">
            &times;
        </button>

        <!-- Title -->
        <h2 class="text-2xl font-semibold text-slate-800 mb-3 text-center">Add User</h2>

        <!-- Form -->
        <form class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6" [formGroup]="registerForm">
            <!-- First Name -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">First Name</label>
                <input type="text" placeholder="Enter first name" formControlName="firstName" [appErrorHandler]="registerForm.controls.firstName"
                 maxlength="15" minlength="3"  class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>

            <!-- Last Name -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Last Name</label>
                <input type="text" placeholder="Enter last name" formControlName="lastName" [appErrorHandler]="registerForm.controls.lastName"
                    maxlength="50" minlength="3"  class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>

            <!-- Email -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                <input type="email" placeholder="Enter email" formControlName="email" [appErrorHandler]="registerForm.controls.email"
                   maxlength="30" minlength="10" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>

            <!-- Contact -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Contact</label>
                <input type="tel" placeholder="Enter contact number" formControlName="contact" [appErrorHandler]="registerForm.controls.contact"
                  maxlength="10" minlength="10"   class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>

            <!-- User Type -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">User Type</label>
                <select formControlName="userType" [appErrorHandler]="registerForm.controls.userType"
                    class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    <option>Admin</option>
                    <option>User</option>
                </select>
            </div>

            <!-- Address (span full width on large screens) -->
            <div class="lg:col-span-3">
                <label class="block text-sm font-medium text-gray-700 mb-1">Address</label>
                <textarea rows="2" placeholder="Enter address" formControlName="address" [appErrorHandler]="registerForm.controls.address"
                   maxlength="50" class="w-full border border-gray-300 rounded-lg px-3 py-3 resize-none focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
            </div>
            <!-- Login Section -->
            <div class="mt-5">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-semibold text-slate-800">Login to your account</h2>
                    <button type="button" (click)="toggleMode()"
                        class="inline-flex items-center gap-2 px-4 py-1.5 rounded-lg bg-indigo-600 text-white text-sm font-medium hover:bg-indigo-700 shadow-sm transition-all">
                        {{ btn }}
                    </button>
                </div>

                <!-- Smooth Transition -->
                <div class="overflow-hidden transition-all duration-500 ease-in-out" [class.max-h-0]="!isLoginMode"
                    [class.max-h-96]="isLoginMode">
                    <!-- Username -->
                    <div>
                        <label class="block text-sm text-slate-600 mb-1" for="loginUsername">Username</label>
                        <input #loginUsername id="loginUsername" formControlName="username" type="text" [appErrorHandler]="registerForm.controls.username"
                          maxlength="15" minlength="15"  class="w-full px-3 py-2 rounded-md border border-slate-200 bg-slate-50 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-300"
                            placeholder="username" />
                    </div>

                    <!-- Password -->
                    <div>
                        <label class="block text-sm text-slate-600 mb-1" for="loginPassword">Password</label>
                        <input id="loginPassword" formControlName="password" type="password" formControlName="password" [appErrorHandler]="registerForm.controls.password"
                            class="w-full px-3 py-2 rounded-md border border-slate-200 bg-slate-50 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-300"
                            placeholder="Enter password" maxlength="8" minlength="8"/>
                    </div>
                </div>
            </div>
        </form>

        <!-- Buttons -->
        <div class="flex justify-end gap-4 mt-8">
            <button class="px-5 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100 transition"
                (click)="employeeForm = false">
                Cancel
            </button>
            <button class="px-5 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 transition" (click)="registerEmployee()">
                Save
            </button>
        </div>
    </div>
</div>
}